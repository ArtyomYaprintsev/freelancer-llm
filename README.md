# Freelancer LLM

## Description

Инструмент анализа данных о доходах фрилансеров

Задача заключается в обработке запросов пользователей, выраженных на естественном языке, и выдаче соответствующих статистических выводов.

Поскольку прямой доступ к большим объёмам данных через языковую модель нежелателен, использовался промежуточный слой обработки данных, позволяющий эффективно извлекать необходимую информацию без передачи большого объёма данных.

## Requirements

- `sqlalchemy` - ORM-инструмент для работы с БД
- `pandas` - библиотека для анализа и манипуляции табличными данными 
- `langchain` - библиотека для построения цепочек обработки данных с участием больших языковых моделей (LLMs)
- `langchain-gigachat` - адаптер для подключения модели GigaChat к LangChain
- `typer` - библиотека для создания интерфейсов командной строки

## Report

### Performance

#### Question #1

> Насколько выше доход у фрилансеров, принимающих оплату в криптовалюте, по сравнению с другими способами оплаты?

|Payment Method|Total|
|:-|:-:|
|Crypto|2641601|
|Bank Transfer|2479859|
|Mobile Banking|2343658|
|PayPal|2319137|

|#|time|Result|Correct|Comment|
|:-:|:-:|:-|:-:|:-|
|1|-|-|:o:|Error: wrong select query|
|2|2.274|Доход фрилансеров, принимающих оплату в криптовалюте, в среднем на 162% выше, чем у тех, кто использует другие способы оплаты.|:o:|Неверный запрос, неверное понимание вопроса|
|3|3.058|-|:o:|Неверная обработка результатов запуска запроса|
|4|1.327|Доход фрилансеров, принимающих оплату в криптовалюте, в среднем на 5139 долларов США выше, чем у тех, кто использует другие способы оплаты.|:white_check_mark:|-|
|5|1.312|Доход фрилансеров, принимающих оплату в криптовалюте, не отличается от дохода тех, кто использует другие способы оплаты. Разница составляет 0%.|:o:|Неверный запрос, неверное понимание вопроса|

#### Question #2

> Как распределяется доход фрилансеров в зависимости от региона проживания?

|Region|Total|
|:-|:-:|
|Australia|1479897|
|Asia|1453412|
|USA|1422901|
|Middle East|1417408|
|UK|1413185|
|Canada|1316133|
|Europe|1281319|

|#|time|Result|Correct|Comment|
|:-:|:-:|:-|:-:|:-|
|1|1.764|Доход фрилансеров распределяется следующим образом: - **Asia**: $1,453,412 - **Australia**: $1,479,897 - **Canada**: $1,316,133 - **Europe**: $1,281,319 - **Middle East**: $1,417,408 - **UK**: $1,413,185 - **USA**: $1,422,901 Больше всего зарабатывают фрилансеры из **Middle East**.|:heavy_check_mark:|Данные получены верно, конечный вывод неверный|
|2|1.862|Доход фрилансеров распределяется следующим образом: - **Asia**: $1,453,412 - **Australia**: $1,479,897 - **Canada**: $1,316,133 - **Europe**: $1,281,319 - **Middle East**: $1,417,408 - **UK**: $1,413,185 - **USA**: $1,422,901 Обратите внимание, что суммы являются доходами в долларах США.|:heavy_check_mark:|Данные получены верно, конечный вывод неверный|
|3|1.684|Доход фрилансеров распределяется следующим образом: - **Asia** — $1,453,412 - **Australia** — $1,479,897 - **Canada** — $1,316,133 - **Europe** — $1,281,319 - **Middle East** — $1,417,408 - **UK** — $1,413,185 - **USA** — $1,422,901|:heavy_check_mark:|-|
|4|1.797|Доход фрилансеров распределяется следующим образом: - **Asia** — общий заработок $1,453,412 - **Australia** — общий заработок $1,479,897 - **Canada** — общий заработок $1,316,133 - **Europe** — общий заработок $1,281,319 - **Middle East** — общий заработок $1,417,408 - **UK** — общий заработок $1,413,185 - **USA** — общий заработок $1,422,901|:heavy_check_mark:|-|
|5|1.790|Доход фрилансеров распределяется следующим образом: - **Asia**: $1,453,412 - **Australia**: $1,479,897 - **Canada**: $1,316,133 - **Europe**: $1,281,319 - **Middle East**: $1,417,408 - **UK**: $1,413,185 - **USA**: $1,422,901 Больше всего зарабатывают фрилансеры из **Middle East**.
|:heavy_check_mark:|Данные получены верно, конечный вывод неверный|

#### Question #3

> Какой процент фрилансеров, считающих себя экспертами, выполнил менее 100 проектов?

|Job Completed|Count|
|:-:|:-|
|>= 100|397 ~0.66%|
|< 100|217 ~0.34%|
|total|614|

|#|time|Result|Correct|Comment|
|:-:|:-:|:-|:-:|:-|
|1|1.979|Процент фрилансеров, считающих себя экспертами, которые выполнили менее 100 проектов, составляет 0%.|:o:|Неверный запрос|
|2|1.241|Ответ: 0.0%|:o:|Неверный запрос|
|3|1.390|В результате вашего SQL запроса было получено 0.0%. Это означает, что среди фрилансеров, которые считают себя экспертами, нет тех, кто выполнил менее 100 проектов.|:o:|Неверный запрос|
|4|1.771|Процент фрилансеров, считающих себя экспертами, которые выполнили менее 100 проектов, составляет 0%.|:o:|Результатом запроса к базе данным была строка: `('Expert', 641, 217, 0.0)`. Запрос отработал в большей степени верно, но вывод неправильный|
|5|1.398|Ответ: 0.0%|:o:|Неверный запрос|

#### Question #4

> При каком формате оплаты работы фрилансеры в среднем получают больше? При часовом или фиксированом?

|Project Type|Avg Earn|
|:-|:-:|
|Hourly|50333.26|
|Fixed|5002.67|

|#|time|Result|Correct|Comment|
|:-:|:-:|:-|:-:|:-|
|1|1.438|Средний заработок фрилансеров при почасовой оплате составляет $4,839.99, а при фиксированной оплате — $5,253.42. Таким образом, фрилансеры в среднем получают больше при фиксированной оплате работы.|:o:|Неверный запрос в следствии неверного понимания данных|
|2|1.316|При оплате через "Bank Transfer" фрилансеры в среднем получают больше — $4,839.99.|:o:|Неверный запрос в следствии невверного понимания данных|
|3|1.647|Средний заработок фрилансеров при почасовой оплате составляет $5,019.96, а при фиксированной оплате — $4,976.69. Таким образом, фрилансеры в среднем получают больше при почасовой оплате.|:o:|Неверный запрос в следствии невверного понимания данных|
|4|1.567|Средний заработок фрилансеров при почасовой оплате составляет $5,019.96, а при фиксированной оплате — $4,976.69. Таким образом, фрилансеры в среднем получают больше при почасовой оплате.|:o:|Неверный запрос в следствии невверного понимания данных|
|5|1.440|Средний заработок фрилансеров при почасовой оплате составляет 5019.96 долларов США, при фиксированной оплате — 4976.69 долларов США. Таким образом, фрилансеры в среднем получают больше при почасовой оплате 
работы.|:o:|Неверный запрос в следствии невверного понимания данных|

#### Question #5

> Какие регионы имеют наибольший процент экспертов среди фрилансеров?
<!-- > Как распределяется доход фрилансеров в зависимости от региона проживания? -->

|Region|Count|
|:-|:-:|
|Middle East|97 ~15.8%|
|Asia|95 ~15.47%|
|UK|93 ~15.15%|
|Australia|92 ~14.98%|
|Europe|90 ~14.66%|
|USA|88 ~14.33%|
|Canada|86 ~14.01%|

|#|time|Result|Correct|Comment|
|:-:|:-:|:-|:-:|:-|
|1|-|-|:o:|Error: no such column `expertise_level`|
|2|1.272|Регионами с наибольшим процентом экспертов среди фрилансеров являются: USA (79.95%), Asia (79.92%, 79.68%) и Middle East (79.69%).|:o:|Невреный запрос (также зачем-то добавил ограничение на 5 первых записей `LIMIT 5`), неверное понимание задачи|
|3|-|-|:o:|Error: no such column `expertise_level`|
|4|-|-|:o:|Error: no such column `expertise_rate`|
|5|1.359|Процентное распределение фрилансеров-экспертов по регионам следующее: все фрилансеры-эксперты находятся в регионе "USA".|:o:|Неверный запрос|

### Analytic

1. **Правильность и точность ответов**: cоответствие выданных ответов фактическим данным.

    Нзикий уровень.

    Хотя большинство числовых данных извлекаются правильно, выводы часто оказываются неверными (например, неверный итоговый вывод в вопросе №2).

    Неверный вывод в вопросе №2 ("Больше всего зарабатывают фрилансеры из Middle East"), ошибка трактовки данных в вопросе №4 ("Фиксированная оплата выгоднее").

2. **Скорость**: скорость выполнения запросов.

    Средний уровень.

    Время выполнения запросов достаточно быстрое; задержки в секунду-две допустимы.

3. **Устойчивость и надежность**: отсутствие ошибок при формировании запросов и устойчивая работа системы.

    Низкий уровень.

    Неверные логические заключения приводят к существенным проблемам в интерпретации данных и ошибка в исполнении кода.

### Conclusion

Разработанный инструмент имеет ряд недостатков, но при этом есть потенциал для эффективной обарботки запросов и анализа данных о доходах фрилансеров.

Главное направление для улучшения — повышение точности понимания запросов и обеспечение правильной логики выводов.
